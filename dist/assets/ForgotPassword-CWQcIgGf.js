import{j as s,M as l,A as w}from"./index-DmeS5GNz.js";import{b as c}from"./vendor-7WqT3uju.js";import{a as h}from"./email-service-BXjt20yX.js";const p=()=>{const e=new Uint8Array(32);return window.crypto.getRandomValues(e),Array.from(e,o=>o.toString(16).padStart(2,"0")).join("")},g=()=>{const e=new Date;return e.setHours(e.getHours()+24),e},y=()=>{const[e,o]=c.useState(""),[n,i]=c.useState(!1),d=async(a,t)=>{const r=await fetch(`${w}/auth/reset-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,token:t,expiresAt:g()})});if(!r.ok){const u=await r.json();throw new Error(u.message||"Failed to save reset token")}return await r.json()},m=async a=>{a.preventDefault(),i(!0);try{const t=p(),r=`${window.location.origin}/reset-password/${t}`;console.log("ForgotPassword: email to reset:",e),console.log("ForgotPassword: reset link:",r),await d(e,t),await h(e,r),l.toast({html:"Password reset link sent to your email!"})}catch(t){console.error("Password reset error:",t),l.toast({html:`Error: ${t.message}`})}finally{i(!1)}};return s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col s12 m6 offset-m3",children:s.jsx("div",{className:"card",children:s.jsxs("div",{className:"card-content",children:[s.jsx("span",{className:"card-title",children:"Forgot Password"}),s.jsxs("form",{onSubmit:m,children:[s.jsxs("div",{className:"input-field",children:[s.jsx("input",{id:"email",type:"email",value:e,onChange:a=>o(a.target.value),required:!0}),s.jsx("label",{htmlFor:"email",children:"Email Address"})]}),s.jsx("button",{className:"btn waves-effect waves-light",type:"submit",disabled:n,children:n?"Sending...":"Send Reset Link"})]})]})})})})})};export{y as default};
