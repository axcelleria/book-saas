import{u as x,M as l,j as e,A as h}from"./index-DmeS5GNz.js";import{u as g,b as d}from"./vendor-7WqT3uju.js";const y=()=>{const{user:t,setUser:p,logout:u}=x(),m=g(),[w,i]=d.useState(!1),[o,f]=d.useState({fullName:(t==null?void 0:t.full_name)||"",email:(t==null?void 0:t.email)||""}),[a,c]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""});d.useEffect(()=>{l.updateTextFields()},[]);const P=async s=>{s.preventDefault(),i(!0);try{const r=await fetch(`${h}/users/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!r.ok)throw new Error("Failed to update profile");const n=await r.json();p(n),l.toast({html:"Profile updated successfully"}),n.email!==t.email&&(await u(),m("/login"))}catch(r){l.toast({html:r.message})}finally{i(!1)}},j=async s=>{if(s.preventDefault(),a.newPassword!==a.confirmPassword){l.toast({html:"New passwords do not match"});return}i(!0);try{const r=await fetch(`${h}/users/${t.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:a.currentPassword,newPassword:a.newPassword})});if(!r.ok){const n=await r.json();throw new Error(n.message)}l.toast({html:"Password updated successfully. Please login again."}),await u(),m("/login")}catch(r){l.toast({html:r.message})}finally{i(!1)}};return e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col s12 m8 offset-m2",children:[e.jsx("h4",{children:"Profile Settings"}),e.jsxs("div",{className:"card-panel",children:[e.jsx("h5",{children:"Personal Information"}),e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{className:"input-field",children:[e.jsx("input",{id:"fullName",type:"text",value:o.fullName,onChange:s=>f({...o,fullName:s.target.value}),required:!0}),e.jsx("label",{htmlFor:"fullName",children:"Full Name"})]}),e.jsxs("div",{className:"input-field",children:[e.jsx("input",{id:"email",type:"email",value:o.email,onChange:s=>f({...o,email:s.target.value}),required:!0}),e.jsx("label",{htmlFor:"email",children:"Email"})]}),e.jsx("button",{type:"submit",className:"btn waves-effect waves-light",disabled:w,children:"Update Profile"})]})]}),e.jsxs("div",{className:"card-panel",children:[e.jsx("h5",{children:"Change Password"}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"input-field",children:[e.jsx("input",{id:"currentPassword",type:"password",value:a.currentPassword,onChange:s=>c({...a,currentPassword:s.target.value}),required:!0}),e.jsx("label",{htmlFor:"currentPassword",children:"Current Password"})]}),e.jsxs("div",{className:"input-field",children:[e.jsx("input",{id:"newPassword",type:"password",value:a.newPassword,onChange:s=>c({...a,newPassword:s.target.value}),required:!0}),e.jsx("label",{htmlFor:"newPassword",children:"New Password"})]}),e.jsxs("div",{className:"input-field",children:[e.jsx("input",{id:"confirmPassword",type:"password",value:a.confirmPassword,onChange:s=>c({...a,confirmPassword:s.target.value}),required:!0}),e.jsx("label",{htmlFor:"confirmPassword",children:"Confirm New Password"})]}),e.jsx("button",{type:"submit",className:"btn waves-effect waves-light",disabled:w,children:"Update Password"})]})]})]})})})};export{y as default};
