import{A as m,j as e}from"./index-DmeS5GNz.js";import{b as i}from"./vendor-7WqT3uju.js";import{M as w}from"./materialize-B2tdm-kr.js";import"./ui-D2T_FE5F.js";const v=async()=>{const s=await fetch(`${m}/categories`);if(!s.ok)throw new Error("Failed to fetch categories");return await s.json()},N=async s=>{const r=await fetch(`${m}/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s.name,description:s.description,parentId:s.parentId||null})});if(!r.ok){const a=await r.json();throw new Error(a.error||"Failed to create category")}return await r.json()},C=async(s,r)=>{const a=await fetch(`${m}/categories/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name,description:r.description,parentId:r.parentId||null})});if(!a.ok){const d=await a.json();throw new Error(d.error||"Failed to update category")}return await a.json()},b=async s=>{const r=await fetch(`${m}/categories/${s}`,{method:"DELETE"});if(!r.ok){const a=await r.json();throw new Error(a.error||"Failed to delete category")}},F=()=>{const[s,r]=i.useState([]),[a,d]=i.useState(null),[n,c]=i.useState({name:"",description:"",parentId:""}),[u,o]=i.useState(""),[x,h]=i.useState("");i.useEffect(()=>{p()},[]),i.useEffect(()=>{const t=document.querySelectorAll("select");w.FormSelect.init(t)},[s]);const p=async()=>{try{const t=await v();r(t)}catch{o("Failed to load categories")}},j=async t=>{t.preventDefault(),o(""),h("");try{a?(await C(a.id,n),h("Category updated successfully")):(await N(n),h("Category created successfully")),c({name:"",description:"",parentId:""}),d(null),p()}catch(l){o(l.message)}},g=t=>{d(t),c({name:t.name,description:t.description||"",parentId:t.parent_id||""})},f=async t=>{if(window.confirm("Are you sure you want to delete this category?"))try{await b(t),h("Category deleted successfully"),p()}catch(l){o(l.message)}};return e.jsxs("div",{className:"row",style:{margin:"20px"},children:[e.jsx("div",{className:"col s4",children:e.jsx("form",{onSubmit:j,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[e.jsx("span",{className:"card-title",children:a?"Edit Category":"Add New Category"}),u&&e.jsx("div",{className:"card-panel red lighten-4 red-text",children:u}),x&&e.jsx("div",{className:"card-panel green lighten-4 green-text",children:x}),e.jsxs("div",{className:"input-field",children:[e.jsx("input",{type:"text",id:"name",value:n.name,onChange:t=>c({...n,name:t.target.value}),required:!0}),e.jsx("label",{htmlFor:"name",className:n.name?"active":"",children:"Category Name *"})]}),e.jsxs("div",{className:"input-field",children:[e.jsxs("select",{id:"parentId",value:n.parentId,onChange:t=>c({...n,parentId:t.target.value}),children:[e.jsx("option",{value:"",children:"Select parent category (optional)"}),s.filter(t=>!t.parent_id).filter(t=>!a||t.id!==a.id).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("label",{children:"Parent Category"})]}),e.jsxs("div",{className:"input-field",children:[e.jsx("textarea",{id:"description",className:"materialize-textarea",value:n.description,onChange:t=>c({...n,description:t.target.value})}),e.jsx("label",{htmlFor:"description",className:n.description?"active":"",children:"Description"})]}),e.jsxs("div",{className:"card-action",style:{paddingLeft:0},children:[e.jsxs("button",{type:"submit",className:"btn waves-effect waves-light",children:[a?"Update":"Add",e.jsx("i",{className:"material-icons right",children:"send"})]}),a&&e.jsxs("button",{type:"button",onClick:()=>{d(null),c({name:"",description:"",parentId:""})},className:"btn grey waves-effect waves-light",style:{marginLeft:"10px"},children:["Cancel",e.jsx("i",{className:"material-icons right",children:"cancel"})]})]})]})})})}),e.jsx("div",{className:"col s8",children:e.jsx("div",{className:"card",style:{margin:0},children:e.jsx("div",{className:"card-content",style:{padding:0},children:e.jsx("div",{style:{height:"75vh",overflow:"auto"},children:e.jsxs("table",{className:"striped highlight",children:[e.jsx("thead",{style:{position:"sticky",top:0,background:"white",zIndex:1,boxShadow:"0 2px 2px rgba(0,0,0,0.1)"},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Parent Category"}),e.jsx("th",{children:"Description"}),e.jsx("th",{style:{width:"120px"},children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>{const l=s.find(y=>y.id===t.parent_id);return e.jsxs("tr",{children:[e.jsx("td",{children:t.name}),e.jsx("td",{children:l?l.name:"-"}),e.jsx("td",{children:t.description||"-"}),e.jsxs("td",{children:[e.jsx("button",{onClick:()=>g(t),className:"btn-small waves-effect waves-light blue",style:{marginRight:"5px"},children:e.jsx("i",{className:"material-icons",children:"edit"})}),e.jsx("button",{onClick:()=>f(t.id),className:"btn-small waves-effect waves-light red",children:e.jsx("i",{className:"material-icons",children:"delete"})})]})]},t.id)})})]})})})})})]})};export{F as default};
